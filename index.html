<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <title>Full Adder</title>
    <!-- Source of the verilog codefor the adder -->
    <!-- https://vlsimaster.wordpress.com/2013/01/26/verilog-code-for-8-bit-ripple-carry-adder-and-testbench/-->
    <!-- Used https://digitaljs.tilk.eu/ to convert he .sv file to a json -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/digitaljs@0.12.1/dist/main.js"></script>
  </head>
  <body>
    <div>
        <button name="start" type="button">▶️</button>
        <button name="stop" type="button">⏹️</button>
    </div>
    <div id="paper">
    </div>
    <div>
        <input name="fixed" type="checkbox" ><label>Fixed Mode</label>
        <button name="json" type="button">Serialize and Reload</button>
        <input name="layout" type="checkbox"><label>Include layout information</label>
    </div>
    <div>
        <button name="ppt_up" type="button">+</button><button name="ppt_down">-</button><button name="left">&lt;</button><button name="right">&gt;</button><button name="live">live</button>
    </div>
    <div id="monitor">
    </div>
    <div id="iopanel">
    </div>
    <script>
      var circuit, monitor, monitorview, iopanel, paper;
      var start = $('button[name=start]');
      var stop = $('button[name=stop]');
      var papers = {};
      const fixed = function (fixed) {
        Object.values(papers).forEach(p => p.fixed(fixed));
      }
      const loadCircuit = function (json) {
        circuit = new digitaljs.Circuit(json);
        monitor = new digitaljs.Monitor(circuit);
        monitorview = new digitaljs.MonitorView({model: monitor, el: $('#monitor') });
        iopanel = new digitaljs.IOPanelView({model: circuit, el: $('#iopanel') });
        circuit.on('new:paper', function(paper) {
          paper.fixed($('input[name=fixed]').prop('checked'));
          papers[paper.cid] = paper;
          paper.on('element:pointerdblclick', (cellView) => {
            window.digitaljsCell = cellView.model;
            console.info('You can now access the doubly clicked gate as digitaljsCell in your WebBrowser console!');
          });
        });
        circuit.on('changeRunning', () => {
          if (circuit.running) {
            start.prop('disabled', true);
            stop.prop('disabled', false);
          } else {
            start.prop('disabled', false);
            stop.prop('disabled', true);
          }
        });
        paper = circuit.displayOn($('#paper'));
        fixed($('input[name=fixed]').prop('checked'));
        circuit.on('remove:paper', function(paper) {
          delete papers[paper.cid];
        });
        circuit.start();
      }
      start.on('click', (e) => { circuit.start(); });
      stop.on('click', (e) => { circuit.stop(); });
      $('button[name=json]').on('click', (e) => {
        monitorview.shutdown();
        iopanel.shutdown();
        circuit.stop();
        const json = circuit.toJSON($('input[name=layout]').prop('checked'));
        console.log(json);
        loadCircuit(json);
      });
      $('input[name=fixed]').change(function () {
        fixed($(this).prop('checked'));
      });
      $('button[name=ppt_up]').on('click', (e) => { monitorview.pixelsPerTick *= 2; });
      $('button[name=ppt_down]').on('click', (e) => { monitorview.pixelsPerTick /= 2; });
      $('button[name=left]').on('click', (e) => { monitorview.live = false; monitorview.start -= monitorview._width / monitorview.pixelsPerTick / 4; });
      $('button[name=right]').on('click', (e) => { monitorview.live = false; monitorview.start += monitorview._width / monitorview.pixelsPerTick / 4; });
      $('button[name=live]').on('click', (e) => { monitorview.live = true; });
      $(window).ready(function () { loadCircuit({"devices":{"dev0":{"label":"a","type":"NumEntry","propagation":0,"numbase":"hex","bits":8,"net":"a","order":0,"position":{"x":12,"y":364}},"dev1":{"label":"b","type":"NumEntry","propagation":0,"numbase":"hex","bits":8,"net":"b","order":1,"position":{"x":12,"y":474}},"dev2":{"label":"cin","type":"Button","propagation":0,"numbase":"hex","bits":1,"net":"cin","order":2,"position":{"x":50,"y":285}},"dev3":{"label":"sum","type":"NumDisplay","propagation":0,"numbase":"hex","bits":8,"net":"sum","order":3,"position":{"x":1734.0666608810425,"y":65}},"dev4":{"label":"cout","type":"Lamp","propagation":0,"numbase":"hex","bits":1,"net":"cout","order":4,"position":{"x":1734.0666608810425,"y":171}},"dev5":{"label":"a1","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":10,"column":13},"to":{"line":10,"column":42}}],"celltype":"fulladd","position":{"x":311.09999990463257,"y":225}},"dev6":{"label":"a2","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":11,"column":13},"to":{"line":11,"column":43}}],"celltype":"fulladd","position":{"x":472.58333253860474,"y":220}},"dev7":{"label":"a3","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":12,"column":13},"to":{"line":12,"column":43}}],"celltype":"fulladd","position":{"x":634.0666651725769,"y":215}},"dev8":{"label":"a4","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":13,"column":13},"to":{"line":13,"column":43}}],"celltype":"fulladd","position":{"x":795.5499978065491,"y":210}},"dev9":{"label":"a5","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":14,"column":13},"to":{"line":14,"column":43}}],"celltype":"fulladd","position":{"x":957.0333304405212,"y":205}},"dev10":{"label":"a6","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":15,"column":13},"to":{"line":15,"column":43}}],"celltype":"fulladd","position":{"x":1118.5166630744934,"y":200}},"dev11":{"label":"a7","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":16,"column":13},"to":{"line":16,"column":43}}],"celltype":"fulladd","position":{"x":1279.9999957084656,"y":195}},"dev12":{"label":"a8","type":"Subcircuit","propagation":0,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":17,"column":13},"to":{"line":17,"column":43}}],"celltype":"fulladd","position":{"x":1441.4833283424377,"y":144}},"dev13":{"label":"","type":"BusGroup","propagation":0,"groups":[1,1,1,1,1,1,1,1],"position":{"x":1602.96666097641,"y":12}},"dev14":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":0,"count":1,"total":8},"position":{"x":180,"y":222}},"dev15":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":0,"count":1,"total":8},"position":{"x":180,"y":266}},"dev16":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":1,"count":1,"total":8},"position":{"x":326.29166626930237,"y":301}},"dev17":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":1,"count":1,"total":8},"position":{"x":326.29166626930237,"y":345}},"dev18":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":2,"count":1,"total":8},"position":{"x":487.77499890327454,"y":367}},"dev19":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":2,"count":1,"total":8},"position":{"x":487.77499890327454,"y":411}},"dev20":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":3,"count":1,"total":8},"position":{"x":649.2583315372467,"y":433}},"dev21":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":3,"count":1,"total":8},"position":{"x":649.2583315372467,"y":477}},"dev22":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":4,"count":1,"total":8},"position":{"x":810.7416641712189,"y":499}},"dev23":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":4,"count":1,"total":8},"position":{"x":810.7416641712189,"y":543}},"dev24":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":5,"count":1,"total":8},"position":{"x":972.224996805191,"y":565}},"dev25":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":5,"count":1,"total":8},"position":{"x":972.224996805191,"y":609}},"dev26":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":6,"count":1,"total":8},"position":{"x":1133.7083294391632,"y":631}},"dev27":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":6,"count":1,"total":8},"position":{"x":1133.7083294391632,"y":675}},"dev28":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":7,"count":1,"total":8},"position":{"x":1295.1916620731354,"y":141}},"dev29":{"label":"","type":"BusSlice","propagation":0,"slice":{"first":7,"count":1,"total":8},"position":{"x":1295.1916620731354,"y":697}}},"connectors":[{"from":{"id":"dev0","port":"out"},"to":{"id":"dev14","port":"in"},"name":"a","vertices":[{"x":130,"y":369},{"x":130,"y":244}]},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev16","port":"in"},"name":"a","vertices":[{"x":130,"y":369},{"x":130,"y":323},{"x":140,"y":313}]},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev18","port":"in"},"name":"a"},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev20","port":"in"},"name":"a","vertices":[{"x":130,"y":389},{"x":130,"y":435},{"x":140,"y":445}]},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev22","port":"in"},"name":"a","vertices":[{"x":130,"y":389},{"x":130,"y":501},{"x":140,"y":511}]},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev24","port":"in"},"name":"a","vertices":[{"x":130,"y":389},{"x":130,"y":567},{"x":140,"y":577}]},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev26","port":"in"},"name":"a","vertices":[{"x":130,"y":389},{"x":130,"y":633},{"x":140,"y":643}]},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev28","port":"in"},"name":"a","vertices":[{"x":130,"y":369},{"x":130,"y":163},{"x":140,"y":153}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev15","port":"in"},"name":"b","vertices":[{"x":120,"y":479},{"x":120,"y":288},{"x":130,"y":278}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev17","port":"in"},"name":"b","vertices":[{"x":120,"y":479},{"x":120,"y":367},{"x":130,"y":357}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev19","port":"in"},"name":"b","vertices":[{"x":120,"y":479},{"x":120,"y":433},{"x":130,"y":423}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev21","port":"in"},"name":"b"},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev23","port":"in"},"name":"b","vertices":[{"x":120,"y":499},{"x":120,"y":545},{"x":130,"y":555}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev25","port":"in"},"name":"b","vertices":[{"x":120,"y":499},{"x":120,"y":611},{"x":130,"y":621}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev27","port":"in"},"name":"b","vertices":[{"x":120,"y":499},{"x":120,"y":677},{"x":130,"y":687}]},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev29","port":"in"},"name":"b","vertices":[{"x":120,"y":499},{"x":120,"y":677},{"x":130,"y":687},{"x":1048.5166630744934,"y":687},{"x":1058.5166630744934,"y":697},{"x":1058.5166630744934,"y":699},{"x":1068.5166630744934,"y":709}]},{"from":{"id":"dev2","port":"out"},"to":{"id":"dev5","port":"cin"},"name":"cin","vertices":[{"x":251.09999990463257,"y":300},{"x":261.09999990463257,"y":290},{"x":261.09999990463257,"y":282}]},{"from":{"id":"dev13","port":"out"},"to":{"id":"dev3","port":"in"},"name":"sum"},{"from":{"id":"dev12","port":"cout"},"to":{"id":"dev4","port":"in"},"name":"cout"},{"from":{"id":"dev14","port":"out"},"to":{"id":"dev5","port":"a"}},{"from":{"id":"dev15","port":"out"},"to":{"id":"dev5","port":"b"},"vertices":[{"x":251.09999990463257,"y":268},{"x":251.09999990463257,"y":263},{"x":261.09999990463257,"y":253}]},{"from":{"id":"dev5","port":"cout"},"to":{"id":"dev6","port":"cin"}},{"from":{"id":"dev5","port":"sum"},"to":{"id":"dev13","port":"in0"},"vertices":[{"x":412.58333253860474,"y":229},{"x":412.58333253860474,"y":31},{"x":422.58333253860474,"y":21}]},{"from":{"id":"dev16","port":"out"},"to":{"id":"dev6","port":"a"},"vertices":[{"x":412.58333253860474,"y":313},{"x":422.58333253860474,"y":303},{"x":422.58333253860474,"y":239}]},{"from":{"id":"dev17","port":"out"},"to":{"id":"dev6","port":"b"},"vertices":[{"x":422.58333253860474,"y":357},{"x":432.58333253860474,"y":347},{"x":432.58333253860474,"y":258}]},{"from":{"id":"dev6","port":"cout"},"to":{"id":"dev7","port":"cin"}},{"from":{"id":"dev6","port":"sum"},"to":{"id":"dev13","port":"in1"},"vertices":[{"x":574.0666651725769,"y":224},{"x":574.0666651725769,"y":48},{"x":584.0666651725769,"y":38}]},{"from":{"id":"dev18","port":"out"},"to":{"id":"dev7","port":"a"},"vertices":[{"x":574.0666651725769,"y":379},{"x":584.0666651725769,"y":369},{"x":584.0666651725769,"y":234}]},{"from":{"id":"dev19","port":"out"},"to":{"id":"dev7","port":"b"},"vertices":[{"x":584.0666651725769,"y":423},{"x":594.0666651725769,"y":413},{"x":594.0666651725769,"y":253}]},{"from":{"id":"dev7","port":"cout"},"to":{"id":"dev8","port":"cin"}},{"from":{"id":"dev7","port":"sum"},"to":{"id":"dev13","port":"in2"},"vertices":[{"x":735.5499978065491,"y":219},{"x":735.5499978065491,"y":65},{"x":745.5499978065491,"y":55}]},{"from":{"id":"dev20","port":"out"},"to":{"id":"dev8","port":"a"},"vertices":[{"x":735.5499978065491,"y":445},{"x":745.5499978065491,"y":435},{"x":745.5499978065491,"y":229}]},{"from":{"id":"dev21","port":"out"},"to":{"id":"dev8","port":"b"},"vertices":[{"x":745.5499978065491,"y":489},{"x":755.5499978065491,"y":479},{"x":755.5499978065491,"y":248}]},{"from":{"id":"dev8","port":"cout"},"to":{"id":"dev9","port":"cin"}},{"from":{"id":"dev8","port":"sum"},"to":{"id":"dev13","port":"in3"},"vertices":[{"x":897.0333304405212,"y":214},{"x":897.0333304405212,"y":82},{"x":907.0333304405212,"y":72}]},{"from":{"id":"dev22","port":"out"},"to":{"id":"dev9","port":"a"},"vertices":[{"x":897.0333304405212,"y":511},{"x":907.0333304405212,"y":501},{"x":907.0333304405212,"y":224}]},{"from":{"id":"dev23","port":"out"},"to":{"id":"dev9","port":"b"},"vertices":[{"x":907.0333304405212,"y":555},{"x":917.0333304405212,"y":545},{"x":917.0333304405212,"y":243}]},{"from":{"id":"dev9","port":"cout"},"to":{"id":"dev10","port":"cin"}},{"from":{"id":"dev9","port":"sum"},"to":{"id":"dev13","port":"in4"},"vertices":[{"x":1058.5166630744934,"y":209},{"x":1058.5166630744934,"y":99},{"x":1068.5166630744934,"y":89}]},{"from":{"id":"dev24","port":"out"},"to":{"id":"dev10","port":"a"},"vertices":[{"x":1058.5166630744934,"y":577},{"x":1068.5166630744934,"y":567},{"x":1068.5166630744934,"y":219}]},{"from":{"id":"dev25","port":"out"},"to":{"id":"dev10","port":"b"},"vertices":[{"x":1068.5166630744934,"y":621},{"x":1078.5166630744934,"y":611},{"x":1078.5166630744934,"y":238}]},{"from":{"id":"dev10","port":"cout"},"to":{"id":"dev11","port":"cin"}},{"from":{"id":"dev10","port":"sum"},"to":{"id":"dev13","port":"in5"},"vertices":[{"x":1219.9999957084656,"y":204},{"x":1219.9999957084656,"y":116},{"x":1229.9999957084656,"y":106}]},{"from":{"id":"dev26","port":"out"},"to":{"id":"dev11","port":"a"},"vertices":[{"x":1219.9999957084656,"y":643},{"x":1229.9999957084656,"y":633},{"x":1229.9999957084656,"y":214}]},{"from":{"id":"dev27","port":"out"},"to":{"id":"dev11","port":"b"},"vertices":[{"x":1229.9999957084656,"y":687},{"x":1239.9999957084656,"y":677},{"x":1239.9999957084656,"y":233}]},{"from":{"id":"dev11","port":"cout"},"to":{"id":"dev12","port":"cin"},"vertices":[{"x":1391.4833283424377,"y":237},{"x":1401.4833283424377,"y":227},{"x":1401.4833283424377,"y":201}]},{"from":{"id":"dev11","port":"sum"},"to":{"id":"dev13","port":"in6"},"vertices":[{"x":1381.4833283424377,"y":199},{"x":1381.4833283424377,"y":133},{"x":1391.4833283424377,"y":123}]},{"from":{"id":"dev28","port":"out"},"to":{"id":"dev12","port":"a"}},{"from":{"id":"dev29","port":"out"},"to":{"id":"dev12","port":"b"},"vertices":[{"x":1381.4833283424377,"y":709},{"x":1391.4833283424377,"y":699},{"x":1391.4833283424377,"y":182}]},{"from":{"id":"dev12","port":"sum"},"to":{"id":"dev13","port":"in7"},"vertices":[{"x":1552.96666097641,"y":140}]}],"subcircuits":{"fulladd":{"devices":{"dev0":{"label":"","type":"Input","propagation":0,"numbase":"hex","bits":1,"net":"a","order":0},"dev1":{"label":"","type":"Input","propagation":0,"numbase":"hex","bits":1,"net":"b","order":1},"dev2":{"label":"","type":"Input","propagation":0,"numbase":"hex","bits":1,"net":"cin","order":2},"dev3":{"label":"","type":"Output","propagation":0,"numbase":"hex","bits":1,"net":"sum","order":3},"dev4":{"label":"","type":"Output","propagation":0,"numbase":"hex","bits":1,"net":"cout","order":4},"dev5":{"label":"$and$8bitfulleradder.sv:28$3","type":"And","propagation":1,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":28,"column":19},"to":{"line":28,"column":22}}],"bits":1,"inputs":2},"dev6":{"label":"$and$8bitfulleradder.sv:28$4","type":"And","propagation":1,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":28,"column":25},"to":{"line":28,"column":30}}],"bits":1,"inputs":2},"dev7":{"label":"$and$8bitfulleradder.sv:28$6","type":"And","propagation":1,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":28,"column":33},"to":{"line":28,"column":38}}],"bits":1,"inputs":2},"dev9":{"label":"$or$8bitfulleradder.sv:28$7","type":"Or","propagation":1,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":28,"column":18},"to":{"line":28,"column":39}}],"bits":1,"inputs":3},"dev11":{"label":"$xor$8bitfulleradder.sv:27$2","type":"Xor","propagation":1,"source_positions":[{"name":"8bitfulleradder.sv","from":{"line":27,"column":17},"to":{"line":27,"column":24}}],"bits":1,"inputs":3}},"connectors":[{"from":{"id":"dev0","port":"out"},"to":{"id":"dev5","port":"in1"},"name":"a"},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev7","port":"in1"},"name":"a"},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev5","port":"in2"},"name":"b"},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev6","port":"in1"},"name":"b"},{"from":{"id":"dev2","port":"out"},"to":{"id":"dev6","port":"in2"},"name":"cin"},{"from":{"id":"dev2","port":"out"},"to":{"id":"dev7","port":"in2"},"name":"cin"},{"from":{"id":"dev9","port":"out"},"to":{"id":"dev4","port":"in"},"name":"cout"},{"from":{"id":"dev7","port":"out"},"to":{"id":"dev9","port":"in3"}},{"from":{"id":"dev5","port":"out"},"to":{"id":"dev9","port":"in1"}},{"from":{"id":"dev6","port":"out"},"to":{"id":"dev9","port":"in2"}},{"from":{"id":"dev11","port":"out"},"to":{"id":"dev3","port":"in"},"name":"sum"},{"from":{"id":"dev2","port":"out"},"to":{"id":"dev11","port":"in3"},"name":"cin"},{"from":{"id":"dev0","port":"out"},"to":{"id":"dev11","port":"in1"},"name":"a"},{"from":{"id":"dev1","port":"out"},"to":{"id":"dev11","port":"in2"},"name":"b"}]}}}) });
    </script>
  </body>
</html>